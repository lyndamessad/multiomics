---
title: "tp_multi-omics"
author: "Lynda"
date: "20/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Consignes

Vous avez jusqu'au 30 Octobre 2020 pour rendre le devoir. Vous devez nous
remettre un fichier Rmd qui contient les réponses à toutes les questions.
Vous inclurez également **toutes les commandes** qui vous ont permises de répondre
aux questions.

N'oubliez pas d'inclure le nom et le prénom de tous les membres de l'équipe.

Vous pouvez nous joindre aux adresses suivantes:

* Arnaud Droit: Arnaud.Droit@crchudequebec.ulaval.ca
* Antoine Bodein: Antoine.Bodein@crchudequebec.ulaval.ca
* Charles Joly Beauparlant: Charles.Joly-Beauparlant@crchudequebec.ulaval.ca

## Objectifs

Utiliser les méthodes vu en cours pour intégrer des données multi-omiques.
Une grande partie du TP est réalisé grâce à la suite d'outils `mixOmics`.
De l'aide est disponible sur leur site (http://mixomics.org/).

---
# Partie I

## 0. Préparation

1. Chargez le package `mixOmics`

2. Téléchargez et importez les données (4 fichiers: `mirna.csv`, `mrna.csv`, `protein.csv`, `sample_group.csv`)

**Question 1:** Combien avez-vous d'échantillons ? de variables (mRNA, protéines, miRNA) ?

Lecture des fichier:
```{r}
miRNA <- read.csv(file = "mirna.csv", header = T, sep ="," ,row.names = 1)
dim(miRNA)

mRNA <- read.csv(file = "mrna.csv", header = T, sep =",", row.names = 1 )
dim(mRNA)

prot <- read.csv(file = "protein.csv", header = T, sep =",", row.names = 1 )
dim(prot)

sampl_group <- read.csv(file = "sample_group.csv", header = T, sep ="," ,row.names = 1)
dim(sampl_group)
```
a/ miRNA: on a  150 échantillons , 184 variables (miRNA).
b/ mRNA: on a  150 échantillons , 200 variables (genes)
c/ prot: on a  150 échantillons , 142 variables (protéines)
d/ sampl_group : on a  150 échantillons , 1 variable


3. Le coefficient de variation est défini comme le rapport entre l'écart-type $\sigma$ et la moyenne $\mu$ : $c_v = \frac{\sigma}{\mu}$
Construisez un fonction qui calcule le coefficient de variation à partir d'un vecteur.


```{r}
coef_var = function(vecteur) {

   return(sd(vecteur)/mean(vecteur))
}



```

4. A l'aide d'un histogramme `hist()` affichez la distribution de chacun des blocs.

Pour cela, on va utiliser la fonction apply() afin d'appliquer la fonction coef_var pour chaque colonne de nos différents tableaux de données
Dans la fonction, on met:
- le nom du tableau de données
- le nombre 1 pour que la fonction s'applique sur les lignes ou 2 pour les colonnes
- le nom de la fonction à appliquer

```{r}
vec_miRNA = apply(miRNA, 2, coef_var) 
vec_mRNA= apply(mRNA, 2, coef_var)
vec_prot = apply(prot, 2, coef_var)
```

```{r}
hist(vec_miRNA,col = "blue") 
hist(vec_mRNA, col = "green") 
hist(vec_prot, col = "red") 
```

**Question 2:** La distribution des coefficients de variation est-elle similaire dans les 3 blocs ?
Si oui, quel type de donnée possède le plus de variabilité ?

D'après les représentations des histogrammes, on peut constater que selon les blocs, la distribution n'est pas la même.
les données de miRNA et mRNA ont toutes les deux un maximum de données avec un coefficient de variation entre 0.5 et 1. 
Par contre, les données protéines ne suit pas le meme principe. 

a. Pour les miRNA, on a une abondance plus importante des coeffcients de variation qui entre 0.05 et 0.1. On a 
b. Pour les mRNA, les coeffcients de variation entre 0.05 et 0.1 sont les plus abondants.
c. Pour les protéines, les coeffcients de variation entre 0 et 50 sont les plus abondants. 
.
```{r}
var(vec_miRNA)
var(vec_mRNA)
var(vec_prot)
```
Ceci confirme donc que les données miRNA et mRNA ont une faible variabilité comparé aux protéines qui ont la plus grande variabilité.


5. Pour chacun des blocs, filtrez les données les plus variantes :|cv| >= 0.15

```{r}
miRNA_filtre = miRNA[,names(which(abs(apply(miRNA, 2, coef_var))>=0.15))]
mRNA_filtre = mRNA[,names(which(abs(apply(mRNA, 2, coef_var))>=0.15))]
prot_filtre = prot[,names(which(abs(apply(prot, 2, coef_var))>=0.15))]
```

**Question 3:**: Combien reste-il de gènes ? de protéines ? de miRNA ?
```{r}
dim(miRNA_filtre)
dim(mRNA_filtre)
dim(prot_filtre)
```

Aprés filtrage des |cv| > 0.15, on trouve:
  a. miRNA :avant filtrage: 184, aprés filtrage 82 miRNA.
  b. mRNA :  avant filtrage : 200, aprés filtrage 8174 genes
  c. proteines: avant filtrage : 142,aprés filtrage 8 142 protéines.
  
On conclu donc que pour les protéines toutes les variables on un |cv| > 0.15.


**Question 4:** Quel est le gène le plus variant ? La protéine associé à ce gène est-elle présente dans le jeu de donnée.
```{r}
gene_plus_variant = vec_mRNA[which(vec_mRNA==max(vec_mRNA))]
sprintf("gene plus variant est le :")  
gene_plus_variant
```
Le gene le plus variant est "PLCD4
**Question 5:** A l'aide des bases de donnée de votre choix répondez aux questions suivantes:
```{r}

```

 * Quel est le rôle de ce gène ? 
 * Sur quel chromosome est-il localisé ? 
 * Quelle est la longueur en nucléotide de sa séquence ?
 * Quelle est la longueur en acides aminés de la protéine associée (ou des isoformes) ?